# 设计文档 02：数据字段与指标规范（V1）

## 1. 目标
定义数据输入、指标派生与输出字段的统一规范，确保各模块可对接与可解释。

## 2. 数据源与基础字段

### 2.1 价格数据（现货黄金/COMEX 期货）
必需字段：
- symbol：标的代码
- date：交易日
- open：开盘价
- high：最高价
- low：最低价
- close：收盘价
- volume：成交量（如可得）

### 2.2 关联资产
必需字段：
- dxy_close：美元指数收盘价
- real_yield：实际利率（10Y）

### 2.3 新闻事件
必需字段：
- news_time：时间
- title：标题
- content：事件具体内容
可选字段：
- source：来源媒体
- url：原文链接
- sentiment：情绪倾向（利多/利空/中性）

## 3. 统一时间尺度
- 主周期：分/日/周/月/年
- 周线以自然周汇总
- 所有数据按统一时区对齐
说明：市场状态、信号与关键位按选中周期计算并输出

## 4. 派生指标规范（中线、稳健）

### 4.1 趋势类
- ma_short：短期均线（如 20）
- ma_mid：中期均线（如 60）
- trend_dir：趋势方向（上/下/无）
- trend_strength：趋势强度（弱/中/强）
说明：数据不足时均线字段可为空（null），前端显示为空线。

### 4.2 区间与结构位
- support_level：支撑位
- resistance_level：阻力位
- range_high：区间上沿
- range_low：区间下沿
- range_mid：区间中轴

### 4.3 波动与风险
- atr：波动度（用于风险过滤）
- vol_state：波动状态（低/中/高）
- risk_flag：风险提示标记（事件/异常）

## 5. 状态与信号字段

### 5.1 市场状态
- market_state：趋势/震荡/不清晰

### 5.2 交易信号
- signal_level：强买/买/观望/卖/强卖
- signal_reason：信号解释摘要

### 5.3 交易建议
- entry_zone：建议入场区
- stop_zone：建议止损区
- target_zone：建议目标区
说明：当信号为观望或条件不足时，建议区字段可为空（null）。

### 5.4 仓位建议
- position_level：低/中/高

## 6. 输出字段与展示映射

### 6.1 文本报告字段
- 市场状态、信号等级、关键位、风险提示、仓位建议
 - news_items：新闻事件列表（具体内容）
可选字段（LLM 增强）：
- llm_explanation：教学型解释（自然语言）

### 6.2 图表字段
- price_series：价格线
- trend_line：趋势线（MA20/MA60）
- key_levels：支撑/阻力/区间边界

### 6.3 聊天字段
- 用户问题
- 对应解释（含信号依据与风险提示）

## 7. 数据质量要求
- 缺失值必须标记并提示
- 不一致的时间对齐需报错
- 关键字段缺失时仅输出“观望”
 - 图表接口返回缺失字段需保持为 null，不得抛错

## 8. 版本说明
- V1 仅包含中线所需核心字段
- 未来可扩展：更多宏观指标、新闻量化评分
