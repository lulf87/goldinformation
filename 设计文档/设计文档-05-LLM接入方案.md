# 设计文档 05：LLM 接入方案（V1，可选）

本文档定义大模型作为“可选增强层”的接入方式，不影响基础功能可用性。

## 1. 目标
- 提升教学型解释的自然语言质量
- 提升新闻语义理解与情绪判断准确度
- 支持开放式追问的聊天体验

## 2. 原则
- 规则层决定信号，LLM 只做解释与语义摘要
- LLM 不可用时，系统自动回退到规则模板
- 不将 LLM 结果用于直接下单或改写信号

## 3. 典型使用点

### 3.1 教学型解释生成
输入：
- 信号结果（强买/买/观望/卖/强卖）
- 关键位与市场状态
- 风险提示与仓位建议

输出：
- 教学型自然语言解释（llm_explanation）

要求：
- 保持与规则信号一致
- 语气稳健、避免强烈承诺

### 3.2 新闻语义增强
输入：
- 新闻标题与具体内容

输出：
- 情绪解释（llm_sentiment_reason，可选）

要求：
- 识别否定/反转语义
- 提示不确定性

### 3.3 Chat 追问
输入：
- 当前分析上下文（信号、关键位、风险提示）
- 用户问题

输出：
- 面向新手的解释与行动建议

要求：
- 保持与当前分析一致
- 回答范围不超出系统信号

## 4. 数据字段（可选扩展）
- llm_explanation：教学型自然语言解释
- llm_sentiment_reason：情绪解释摘要

## 5. 回退策略
- LLM 超时/失败：使用规则模板
- LLM 输出与信号冲突：以规则信号为准

## 6. 调用频率建议
- 自动刷新：随金价刷新或按需触发
- Chat：按需调用，优先缓存近期上下文

## 7. 验收清单
- [ ] LLM 不可用时，系统正常输出解释与信号
- [ ] LLM 输出与信号一致，无冲突
- [ ] 新闻语义理解具备解释性，不依赖关键词堆叠
